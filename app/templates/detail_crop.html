{% extends "base.html" %}

{% block title %}{{ crop.name }} - Farmer's Delight Wiki{% endblock %}

{% block content %}
<section>
    <header>
        <h1>ğŸŒ± {{ crop.name }}</h1>
        <p>Explore the details of this crop and related meals!</p>
    </header>

    <div class="detail-content">
        {% if crop.image_url %}
            <img src="{{ crop.image_url }}" alt="{{ crop.name }}" class="detail-image" loading="lazy">
        {% else %}
            <div class="placeholder-image" style="width: 100%; height: 350px; border-radius: var(--border-radius);">
                <span style="font-size: 4rem;">ğŸŒ¿</span>
                <p>No image available</p>
            </div>
        {% endif %}

        <div class="detail-info">
            <h2>ğŸ“‹ Basic Information</h2>
            <dl>
                <dt>ğŸ Hunger Restored</dt>
                <dd>{{ crop.hunger_points }}</dd>

                {% if crop.description %}
                <dt>ğŸ“– Description</dt>
                <dd class="description-text">{{ crop.description }}</dd>
                {% endif %}
            </dl>

            <div class="like-section">
                <button class="like-btn"
                        data-type="crop"
                        data-id="{{ crop.id }}"
                        aria-label="Like this crop"
                        {% if not current_user.is_authenticated %}disabled title="Please log in first"{% endif %}>
                    <span class="like-icon">{% if is_liked %}â¤ï¸{% else %}ğŸ¤{% endif %}</span>
                    <span class="like-count">{{ crop.get_likes_count() }}</span>
                </button>
            </div>
        </div>
    </div>

    {% if related_meals %}
    <section class="related-meals">
        <h2>ğŸ½ï¸ Meals using this crop</h2>
        <div class="meal-grid">
            {% for meal in related_meals %}
            <article class="meal-card">
                {% if meal.image_url %}
                    <img src="{{ meal.image_url }}" alt="{{ meal.name }}" loading="lazy">
                {% else %}
                    <div class="placeholder-image">
                        <span>ğŸ½ï¸</span>
                        <p>No image available</p>
                    </div>
                {% endif %}
                <h3><a href="{{ url_for('main.meal_detail', id=meal.id) }}">{{ meal.name }}</a></h3>
            </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</section>
{% endblock %}

{% block extra_scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        initLikeButtons();
    });
</script>
{% endblock %}

