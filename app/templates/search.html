{% extends "base.html" %}

{% block title %}æœç´¢ - Farmer's Delight Wiki{% endblock %}

{% block content %}
<section>
    <header>
        <h1>ğŸ” æœç´¢</h1>
        <p>åœ¨ Farmer's Delight çš„ä¸–ç•Œä¸­å¯»æ‰¾æ‚¨æƒ³è¦çš„ä½œç‰©æˆ–èœå“ï¼</p>
    </header>

    <form method="POST" action="{{ url_for('main.search') }}" class="search-form" role="search">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.keyword.label }}
            {{ form.keyword(class="form-control", placeholder="è¾“å…¥ä½œç‰©æˆ–èœå“çš„åç§°", aria_label="æœç´¢å…³é”®è¯", aria_describedby="keyword-help") }}
            <small id="keyword-help" class="form-text">ğŸ’¡ è¾“å…¥ä½œç‰©æˆ–èœå“çš„åç§°æˆ–æè¿°</small>
            {% if form.keyword.errors %}
                <div class="error-message" role="alert">
                    {% for error in form.keyword.errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <div class="form-group">
            {{ form.search_type.label }}
            <div class="radio-group" role="radiogroup" aria-label="æœç´¢ç±»å‹">
                {% for subfield in form.search_type %}
                    <label>
                        {{ subfield }}
                        {{ subfield.label.text }}
                    </label>
                {% endfor %}
            </div>
        </div>

        <div class="form-group">
            {{ form.sort_by.label }}
            {{ form.sort_by(class="form-control", aria_label="æ’åºæ–¹å¼") }}
        </div>

        <div class="form-group">
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>

    {% if results is defined %}
        <section class="search-results">
            <h2>ğŸ“‹ æœç´¢ç»“æœ</h2>
            {% if results %}
                <div class="results-grid">
                    {% for item in results %}
                        {% if item.__class__.__name__ == 'Crop' %}
                            <article class="crop-card">
                                {% if item.image_url %}
                                    <img src="{{ item.image_url }}" alt="{{ item.name }}" loading="lazy">
                                {% else %}
                                    <div class="placeholder-image">
                                        <span>ğŸŒ¿</span>
                                        <p>æš‚æ— å›¾ç‰‡</p>
                                    </div>
                                {% endif %}
                                <h3><a href="{{ url_for('main.crop_detail', id=item.id) }}">{{ item.name }}</a></h3>
                                <p class="crop-stats">ğŸ æ¢å¤é¥±é£Ÿåº¦: {{ item.hunger_points }}</p>
                            </article>
                        {% else %}
                            <article class="meal-card">
                                {% if item.image_url %}
                                    <img src="{{ item.image_url }}" alt="{{ item.name }}" loading="lazy">
                                {% else %}
                                    <div class="placeholder-image">
                                        <span>ğŸ½ï¸</span>
                                        <p>æš‚æ— å›¾ç‰‡</p>
                                    </div>
                                {% endif %}
                                <h3><a href="{{ url_for('main.meal_detail', id=item.id) }}">{{ item.name }}</a></h3>
                                <p class="meal-stats">ğŸ æ¢å¤é¥±é£Ÿåº¦: {{ item.hunger_restored }}</p>
                            </article>
                        {% endif %}
                    {% endfor %}
                </div>
            {% else %}
                <div class="no-results" role="alert">
                    <h3>ğŸ” æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</h3>
                    <p>è¯·å°è¯•å…¶ä»–å…³é”®è¯æˆ–æ£€æŸ¥æ‹¼å†™ã€‚</p>
                </div>
            {% endif %}
        </section>
    {% endif %}
</section>
{% endblock %}

